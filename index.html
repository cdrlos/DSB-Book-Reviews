<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Samal Abdikerimova, Ravi Donepudi, Carlos Salinas, and Xiran Yu" />


<title>Book review statistics</title>

<script src="index_files/header-attrs-2.1/header-attrs.js"></script>
<script src="index_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="index_files/bootstrap-3.3.5/css/cerulean.min.css" rel="stylesheet" />
<script src="index_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="index_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="index_files/navigation-1.1/tabsets.js"></script>
<link href="index_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="index_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>




<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>



<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="fluid-row" id="header">



<h1 class="title toc-ignore">Book review statistics</h1>
<h4 class="author">Samal Abdikerimova, Ravi Donepudi, Carlos Salinas, and Xiran Yu</h4>

</div>


<div id="book-review-statistics" class="section level1">
<h1>Book review statistics</h1>
<div id="ideas" class="section level2">
<h2>Ideas</h2>
<ol style="list-style-type: decimal">
<li>Look at relationship between reviews and pages.</li>
<li>Filter by language.</li>
<li>Relationship between popularity and gender.</li>
<li>Language and popularity.</li>
<li>Genre popularity through the years.</li>
<li>Publisher relationship with rating.</li>
<li>Publisher and gender relationship.</li>
</ol>
<p>Note that there is an Goodreads API and that somebody has written an R interface to it, however we do not have enough time to explore it and get it to do as we want. What we will do instead is use the data set found on Kaggle <a href="https://www.kaggle.com/jealousleopard/goodreadsbooks/">here</a>together with the Goodreads API to answer some of the questions above.</p>
<p>First we import the data and take a good look.</p>
<pre class="r"><code>books &lt;- read_csv(&quot;data/books.csv&quot;) %&gt;%
    rename(rating = average_rating,
           total_ratings = ratings_count,
           lang = language_code,
           pages = num_pages)
books</code></pre>
<pre><code>## # A tibble: 8,472 x 12
##    bookID title authors rating isbn  isbn13 lang  pages total_ratings
##     &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;    &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;dbl&gt;         &lt;dbl&gt;
##  1      1 &quot;Har… J.K. R…   4.57 0439… 97804… eng     652       2095690
##  2      2 &quot;Har… J.K. R…   4.49 0439… 97804… eng     870       2153167
##  3      4 &quot;Har… J.K. R…   4.42 0439… 97804… eng     352          6333
##  4      5 &quot;Har… J.K. R…   4.56 0439… 97804… eng     435       2339585
##  5      8 &quot;Har… J.K. R…   4.78 0439… 97804… eng    2690         41428
##  6      9 &quot;Una… W. Fre…   3.74 0976… 97809… en-US   152            19
##  7     10 &quot;Har… J.K. R…   4.73 0439… 97804… eng    3342         28242
##  8     12 &quot;The… Dougla…   4.38 0517… 97805… eng     815          3628
##  9     13 &quot;The… Dougla…   4.38 0345… 97803… eng     815        249558
## 10     14 &quot;The… Dougla…   4.22 1400… 97814… eng     215          4930
## # … with 8,462 more rows, and 3 more variables: text_reviews_count &lt;dbl&gt;,
## #   publication_date &lt;chr&gt;, publisher &lt;chr&gt;</code></pre>
<p>Let’s get more of an idea of what we are working with. Since we speak English we’d like to focus solely on English language books. But first let’s see how many of them we have</p>
<pre class="r"><code>books %&gt;%
    subset(is.na(as.numeric(lang))) %&gt;%
    subset(!is.na(lang)) %&gt;%
    group_by(lang) %&gt;%
    tally() %&gt;%
    arrange(desc(n)) %&gt;%
    ggplot(aes(x = factor(lang, levels = lang), y = n, fill = lang)) +
    geom_bar(stat = &quot;identity&quot;) +
    labs(title = &quot;Title number of books by language&quot;,
         x = &quot;language&quot;,
         y = &quot;number of books&quot;) +
    theme(axis.text.x = element_text(angle=90, hjust=1))</code></pre>
<pre><code>## Warning in eval(e, x, parent.frame()): NAs introducidos por coerción</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Nice, so the overwhelming majority of the data is in <code>eng</code>. However, it looks like US and Great Britain version of books fall under a different language tag (and if we search hard Canadian too). For our purposes <code>"en-CA", ``"en-GB"</code>, and <code>en-US</code> are the same so let us clean up the data a little</p>
<pre class="r"><code>books$lang &lt;- books %&gt;%
    pull(lang) %&gt;%
    str_replace_all(&quot;en*(g|-GB|-US|-CA)&quot;, &quot;eng&quot;)</code></pre>
<p>Another way to deal with this problem is simply to ignore these variants by filtering them out of the data set. Now, since the overwhelming majority of the books in this data set are in English, we will focus our attention on <code>"eng"</code>.</p>
<pre class="r"><code>eng_books &lt;- books %&gt;% filter(lang == &quot;eng&quot;) %&gt;% filter(rating &gt;= 3)</code></pre>
<p>One thing we might one to look at first is the distribution of ratings for English books. We do this as follows</p>
<pre class="r"><code>eng_books %&gt;%
    group_by(rating) %&gt;%
    summarize(total_books = n()) %&gt;%
    ungroup() %&gt;%
    ggplot(aes(x = rating)) +
    geom_bar(aes(y = total_books/1.000001, fill = rating),
             stat = &quot;identity&quot;) +
    labs(title = &quot;Total number of books per rating&quot;,
         x = &quot;average rating&quot;,
         y = &quot;number of books&quot;)</code></pre>
<p><img src="index_files/figure-html/plot%20ratings-1.png" width="672" /></p>
<p>OK, to make better sense of this data let’s take a look at how many people are reading these books</p>
<p>and who are the most prolific writers</p>
<pre class="r"><code>eng_books %&gt;%
    group_by(authors) %&gt;%
    summarize(count = n()) %&gt;%
    arrange(desc(count)) %&gt;%
    ungroup() %&gt;%
    slice(1:10)</code></pre>
<pre><code>## # A tibble: 10 x 2
##    authors                     count
##    &lt;chr&gt;                       &lt;int&gt;
##  1 Stephen King                   31
##  2 Sandra Brown                   27
##  3 Dick Francis                   26
##  4 James Patterson                22
##  5 Margaret Weis/Tracy Hickman    21
##  6 Orson Scott Card               20
##  7 Terry Pratchett                20
##  8 Gordon Korman                  19
##  9 Piers Anthony                  18
## 10 Alan Dean Foster               17</code></pre>
<p>Stephen King—that was sort of expected—and who are the top rated authors</p>
<pre class="r"><code>eng_books %&gt;%
    group_by(authors) %&gt;%
    summarize(average_rating = sum(rating)/n()) %&gt;%
    arrange(desc(average_rating)) %&gt;%
    ungroup() %&gt;%
    slice(1:10)</code></pre>
<pre><code>## # A tibble: 10 x 2
##    authors                                              average_rating
##    &lt;chr&gt;                                                         &lt;dbl&gt;
##  1 Chris    Green/Chris Wright/Paul Douglas Gardner                  5
##  2 James E. Campbell                                                 5
##  3 Julie Sylvester/David Sylvester                                   5
##  4 Keith Donohue                                                     5
##  5 Laura Driscoll/Alisa Klayman-Grodsky/Eric     Weiner              5
##  6 Middlesex Borough Heritage Committee                              5
##  7 Ross Garnaut                                                      5
##  8 Sheri Rose Shepherd                                               5
##  9 Todd Davis/Marc Frey                                              5
## 10 William C. Dowling                                                5</code></pre>
<p>who are these people? So highly rated authors are not necessarily notable ones, perhaps there is a better way to measure top authors.</p>
<pre class="r"><code>eng_books %&gt;%
    (function(...) {
        tmp &lt;- tibble(...)
        tmp$authors &lt;- tmp$authors %&gt;%
            str_replace_all(&quot;Margaret Weis/Tracy Hickman&quot;,
                            &quot;Weis/Hickman&quot;)
        tmp}) %&gt;%
    group_by(authors) %&gt;%
    summarize(book_count = n(),
              sum_rating = sum(rating)) %&gt;%
    arrange(desc(sum_rating)) %&gt;%
    slice(1:10) %&gt;%
    ggplot(aes(factor(authors, levels = authors), sum_rating, fill = authors)) +
    geom_col() +
    coord_flip() +
    labs(title = &quot;Author rankings&quot;,
         y = &quot;author&quot;,
         x = &quot;sum rating&quot;) +
    scale_fill_brewer(palette=&quot;Spectral&quot;)</code></pre>
<p><img src="index_files/figure-html/good%20books-1.png" width="672" /></p>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
